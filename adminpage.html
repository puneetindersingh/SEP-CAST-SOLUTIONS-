<!DOCTYPE html>
<html>
<head>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){

	$('#userRadio').hide();
  $('input[type="radio"]').click(function(){
 if($(this).attr('value') == 'admin') {
   $('#userRadio').hide();
 }else
 {
  $('#userRadio').show();
 }
    });
});

window.onload=checkCookie();

function topnav() {
    var x = document.getElementById("myTopnav");
    if (x.className === "col-12 topnav") {
        x.className += " responsive";
    } else {
        x.className = "col-12 topnav";
    }
}
function openCity(evt, cityName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(cityName).style.display = "block";
    evt.currentTarget.className += " active";
    if(cityName == "modifyUser"){
      getcompany();
    }
		if(cityName == "modifyCompany"){
			showTableforC();
		}
}
var company = new Array();
function selectOp(array){
    var s = document.getElementById("companyselect");
		s.options.length=0;
    for(var a=0; a<array.length;a++){
        var op = document.createElement("option");
				if(a==0){
					op.setAttribute("value",0);
			    op.appendChild(document.createTextNode("Please Select a company..."));
			    s.appendChild(op);
				}else{
					op.setAttribute("value",array[a-1]);
	        op.appendChild(document.createTextNode(array[a-1]));
	        s.appendChild(op);
				}

  }
}

var d = new Date();
var exdays = 30;
d.setTime(d.getTime()+(exdays*24*60*60*1000));
var expires = "expires="+d.toGMTString();

function logOut(){
  document.cookie = "loginstatus=no; "+expires;
}
// Get the element with id="defaultOpen" and click on it
document.getElementById("defaultOpen").click();
function getCookie(cname){
	var name = cname + "=";
	var ca = document.cookie.split(';');
	for(var i=0; i<ca.length; i++) {
		var c = ca[i].trim();
		if (c.indexOf(name)==0) return c.substring(name.length,c.length);
	}
	return "";
}
function checkCookie(){
	var user=getCookie("username");
  var status=getCookie("loginstatus");
  if(status!="" && status =="yes"){
    	if (user!=""){
    		document.getElementById('admin').innerHTML = user;
    	}
    	else {
        alert('no exist Cookie!');
      }
    }else{
      window.location = "./login.html";
    }
}
var xmlHttp;

function getcompany(){
  xmlHttp = GetXmlHttpObject();
if (xmlHttp==null)
 {
 alert ("Browser does not support HTTP Request");
 return 0;
 }
 var url="function-modified.php";
 var params = "";
 params += "getCompany=1";
 xmlHttp.open("POST",url,true);
 xmlHttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
 xmlHttp.onreadystatechange=stateChangedforC;
 xmlHttp.send(params);
}
function stateChangedforC(){
if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete"){
    company = xmlHttp.responseText.split(",");
    selectOp(company);
 }
}

function showTableforU(companyN){
  xmlHttp = GetXmlHttpObject();
if (xmlHttp==null)
 {
 alert ("Browser does not support HTTP Request");
 return 0;
 }
 var url="function-modified.php";
 var params = "";
 params += "displayU=1&companyN="+companyN;
 xmlHttp.open("POST",url,true);
 xmlHttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
 xmlHttp.onreadystatechange=stateChangedforshowU;
 xmlHttp.send(params);
}

function stateChangedforshowU(){
if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete"){
  document.getElementById('modifyUserTable').innerHTML=xmlHttp.responseText;
 }
}

function GetXmlHttpObject(){
var xmlHttp=null;
try{
 // Firefox, Opera 8.0+, Safari
 xmlHttp=new XMLHttpRequest();
 }
catch (e){
 //Internet Explorer
 try{
  xmlHttp=new ActiveXObject("Msxml2.XMLHTTP");
  }
 catch (e){
  xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
 }
return xmlHttp;
}

var row = 0 ;
var myreg = /^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;
var myreg1 = /^(\+61)[0-9]{1}[0-9]{4}[0-9]{4}$/;
function getRow(r){
  var i = r.parentNode.rowIndex;
  return i;
}

function InfobyRow(r){
  var arr = new Array();
 for(var m=0 ; m<8;m++){
  arr[m] = document.getElementById('editable').rows[row].cells[m].innerText;
 }
 return arr ;
}

function delRow(r){
  row = getRow(r);
  var arr = new Array();
  arr = InfobyRow(row);
  if(confirm("Are you sure to delete this user?")){
    document.getElementById('editable').deleteRow(row);
    deleteUser(arr[0]);
  }
}

function updateRow(r){
  row = getRow(r);
  var array = new Array();
  array = InfobyRow(row);
  editUser(array);
}

function deleteUser(username){
  xmlHttp = GetXmlHttpObject();
if (xmlHttp==null)
 {
 alert ("Browser does not support HTTP Request");
 return 0;
 }
 var url='function-modified.php';
 var params = "";
 params += "deleteU=1&username="+username;
 // var params = "username="+document.getElementById('reset-username').value+"&email="+document.getElementById('email-name').value;
 xmlHttp.open("POST",url,true);
 xmlHttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
 xmlHttp.onreadystatechange=stateChangedforDel;
 xmlHttp.send(params);
}

function stateChangedforDel(){
if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete"){
  alert(xmlHttp.responseText);
 }
}

function editUser(array){
  xmlHttp = GetXmlHttpObject();
if (xmlHttp==null)
 {
 alert ("Browser does not support HTTP Request");
 return 0;
 }
 var url='function-modified.php';
 var params = "";
 var phone = array[4];
 phone = phone.replace(/\+/g, "%2B");
 params += "editU=1&username="+array[0]+"&firstname="+array[1]
 +"&lastname="+array[2]+"&email="+array[3]
 +"&phone="+phone+"&companyname="+array[5]
 +"&companysite="+array[6]+"&jobtitle="+array[7];
 // var params = "username="+document.getElementById('reset-username').value+"&email="+document.getElementById('email-name').value;
 xmlHttp.open("POST",url,true);
 xmlHttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
 xmlHttp.onreadystatechange=stateChangedforEditU;
 xmlHttp.send(params);
}

function stateChangedforEditU(){
if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete"){
  alert(xmlHttp.responseText);
 }
}

function companyInfobyRow(r){
  var arr = new Array();
 for(var m=0 ; m<4;m++){
  arr[m] = document.getElementById('tableForC').rows[row].cells[m].innerText;
 }
 return arr ;
}

function delCompany(r){
  row = getRow(r);
  var array = new Array();
  array = companyInfobyRow(row);
  if(confirm("Are you sure to delete this user?")){
    document.getElementById('editable').deleteRow(row);
    deleteCompany(array[0]);
  }
}

function updateCompany(r){
  row = getRow(r);
  var array1 = new Array();
  array1 = companyInfobyRow(row);
  editCompany(array1);
}


function deleteCompany(companyN){
  xmlHttp = GetXmlHttpObject();
if (xmlHttp==null)
 {
 alert ("Browser does not support HTTP Request");
 return 0;
 }
 var url='function-modified.php';
 var params = "";
 params += "deleteC=1&companyName="+companyN;
 // var params = "username="+document.getElementById('reset-username').value+"&email="+document.getElementById('email-name').value;
 xmlHttp.open("POST",url,true);
 xmlHttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
 xmlHttp.onreadystatechange=stateChangedforDelC;
 xmlHttp.send(params);
}

function stateChangedforDelC(){
if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete"){
  alert(xmlHttp.responseText);
 }
}

function editCompany(array){
  xmlHttp = GetXmlHttpObject();
if (xmlHttp==null)
 {
 alert ("Browser does not support HTTP Request");
 return 0;
 }
 var url='function-modified.php';
 var params = "";
 var phone = array[2];
 phone = phone.replace(/\+/g, "%2B");
 params += "editC=1&companyName="+array[0]+"&companyAddress="+array[1]
 +"&companyPhone="+phone+"&companySite="+array[3];
 // var params = "username="+document.getElementById('reset-username').value+"&email="+document.getElementById('email-name').value;
 xmlHttp.open("POST",url,true);
 xmlHttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
 xmlHttp.onreadystatechange=stateChangedforEditC;
 xmlHttp.send(params);
}

function stateChangedforEditC(){
if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete"){
  alert(xmlHttp.responseText);
 }
}

function showTableforC(){
  xmlHttp = GetXmlHttpObject();
if (xmlHttp==null)
 {
 alert ("Browser does not support HTTP Request");
 return 0;
 }
 var url="function-modified.php";
 var params = "";
 params += "displayC=1";
 xmlHttp.open("POST",url,true);
 xmlHttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
 xmlHttp.onreadystatechange=stateChangedforshowC;
 xmlHttp.send(params);
}
function stateChangedforshowC(){
if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete"){
  document.getElementById('modifyCompany').innerHTML=xmlHttp.responseText;
 }
}
</script>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Admin | Cast Solution</title>
 <link rel="stylesheet" href="css/mainPage.css">
 <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
</head>
<body onload="checkCookie()">

<div class="row">

<!-- top nav -->

<div class="col-12 topnav" id="myTopnav">

  <a id="logoleftTop"><img id="logo" src="img/LOGO-01.png"/></a>
  <a href="#Admin"><i class="material-icons md-18 blue">account_box</i><text id="admin"> ADMIN</text></a>
  <a href="#Qlik">Qlik</a>
  <a class="tablinks" onclick="openCity(event, 'contact')"><i class="material-icons md-18 blue">contact_phone</i> CONTACT</a>
  <a class="tablinks" onclick="openCity(event, 'aboutform')"><i class="material-icons md-18 blue">lightbulb_outline</i> ABOUT</a>
  <a href="javascript:void(0);" style="font-size:15px;" class="icon" onclick="topnav()">&#9776;</a>
</div>

<!-- side bar -->
<div class="col-2 menu">
  <ul>
    <li class="tablinks" onclick="openCity(event, 'addNewUser')"><i class="material-icons md-18 blue">person_add</i> Add new user</li>
    <li class="tablinks" onclick="openCity(event, 'modifyUser')"><i class="material-icons md-18 blue">supervisor_account</i> Modify user</li>
    <li class="tablinks" onclick="openCity(event, 'addCompany')"><i class="material-icons md-18 blue">note_add</i> Add Company</li>
    <li class="tablinks" onclick="openCity(event, 'modifyCompany')"><i class="material-icons md-18 blue">assignment</i> Modify Company</li>
    <li><i class="material-icons md-18 blue">help</i> Help</li>
<li> <i class="material-icons md-18 blue">power_settings_new</i><a href="login.html" style="text-decoration: none;  color: black; "> Log Out</a></li>
    <li class="dropdown">
    <a class="dropbtn"><i class="material-icons md-18 blue">settings_applications</i> Settings</a>
    <div class="dropdown-content">
      <a class="tablinks" href="#" onclick="openCity(event, 'passReset')"><i class="material-icons md-18 blue">settings</i> Password Reset</a>
      <a href="#"><i class="material-icons md-18 blue">settings</i> Function 2</a>
      <a href="#"><i class="material-icons md-18 blue">settings</i> Function 3</a>
    </div>
  </li>
  </ul>
</div>

<!-- new form -->
<div class="col-14 divAddUser allform tabcontent" id="addNewUser">
  <form action="add_user.php" method="POST">
    <input id="searchBar" type="text" placeholder="Search user">
    <h4>User information</h4>

	    	<label for="fname">Member Type</label> <br>
    <input type="radio"  id= "admin" name="member" value="admin" checked> <label><b>Admin</b></label>
    <input type="radio"  id="user" name="member" value="user"><label><b>User</b></label><br><br>


    <label for="fname">Username</label>
    <input type="text" name="username" placeholder="User name.." required>
    <label for="fname">Password</label>
    <input type="text" name="password" placeholder="Password.." required>
    <label for="fname">First Name</label>
    <input type="text" name="fname" placeholder="Your name.." required>
    <label for="lname">Last Name</label>
    <input type="text" name="lname" placeholder="Your last name.." required>
    <label for="lname">Email address</label>
    <input type="text" name="email" placeholder="Your email address.." required>
    <label for="lname">Phone number</label>
    <input type="text" name="phone" placeholder="Your phone number.." required>

	  <div id="userRadio">
    <label for="lname">Company Name</label>
    <input type="text" name="company" placeholder="Your company name.." required>
    <label for="lname">Company WebSite</label>
    <input type="text" name="url" placeholder="Your company site name.." required>
    <label for="lname">Company Job Title</label>
    <input type="text"  name ="jobtitle" placeholder="Your company job title.." required>
	  </div>
    <input type="submit"  name="add_user" value="Add user">
  </form>
</div>


<div class="col-13 alltable divAddUser tabcontent" id="modifyUser" style="overflow-x:auto;">
  <div class="filterCompany">
  <text>Company Name:</text></div>
  <div class="filterCompany">
  <select id="companyselect" onchange="showTableforU(this.value)">
    <!-- <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option> -->
  </select>
  </div>
  <div id="modifyUserTable">
 <!-- <table>
  <tr>
    <th>First Name</th>
    <th>Last Name</th>
    <th>Email address</th>
    <th>Phone</th>
    <th>Company</th>
    <th>Company Site Name</th>
    <th>Company Job Title</th>
  </tr>
  </table> -->
</div>
</div>


<div class="col-14 divAddUser allform tabcontent" id="addCompany">
  <form action="add_company.php" method="POST">
    <input id="searchBar" type="text" placeholder="Search company..">
    <h4>Company information</h4>


    <label for="fname">Company Name</label>
    <input type="text" name="name" placeholder="Company name.." required>
    <label for="lname">Company Address</label>
    <input type="text" name="address" placeholder="Company address.." required>
    <label for="lname">Company Phone</label>
    <input type="text" name="phone" placeholder="Company phone.." required>
    <label for="lname">Company URL</label>
    <input type="text" name="site" placeholder="Company URL.." required>
    <input type="submit" value="Add Company" name="add_company">
  </form>
</div>

<div class="col-13 divAddUser all tabcontent" id="modifyCompany" style="overflow-x:auto;">
 <!-- <table>
  <tr>
    <th>Company Name</th>
    <th>Company Address</th>
    <th>Company Phone</th>
    <th>PCompany URL</th>
  </tr>
  </table> -->

</div>

<div class="col-14 divAddUser allform tabcontent" id="passReset">
  <form action="/action_page.php">
    <h4>Password Reset</h4>
    <label for="fname">Old Password</label>
    <input type="password" pattern=".{6,}" title="Six or more characters"placeholder="Your old password"required>
    <label for="fname">New Password</label>
    <input type="password" pattern=".{6,}" title="Six or more characters"placeholder="Your new password"required>
    <input type="submit" value="Submit">
  </form>
</div>

 <!-- contact form -->
<div class="col-14 divAddUser allform tabcontent" id="contact">
  <form action="/action_page.php">
    <h4>Contact Us</h4>
    <label for="fname">Name</label>
    <input type="text" placeholder="Your name"required>
    <label for="fname">Email</label>
    <input type="email" placeholder="Your email"required>
    <label for="fname">Subject</label>
    <input type="text" placeholder="Subject"required>
    <label for="fname">Message</label>
    <textarea rows="10" type="text" placeholder="..."required></textarea>
    <input type="submit" value="Submit">
  </form>
</div>

<!-- About form -->
<div class="col-14 divAddUser allform tabcontent" id="aboutform">

  <div class="row">
  <div class="column">
    <div class="card">
      <img src="/w3images/team1.jpg" alt="Jane" style="width:100%">
      <div class="container">
        <h2>Jane Doe</h2>
        <p class="title">CEO & Founder</p>
        <p>Some text that describes me lorem ipsum ipsum lorem.</p>
        <p>example@example.com</p>
        <p><button class="button">Contact</button></p>
      </div>
    </div>
  </div>

  <div class="column">
    <div class="card">
      <img src="/w3images/team2.jpg" alt="Mike" style="width:100%">
      <div class="container">
        <h2>Mike Ross</h2>
        <p class="title">Art Director</p>
        <p>Some text that describes me lorem ipsum ipsum lorem.</p>
        <p>example@example.com</p>
        <p><button class="button">Contact</button></p>
      </div>
    </div>
  </div>
  <div class="column">
    <div class="card">
      <img src="/w3images/team3.jpg" alt="John" style="width:100%">
      <div class="container">
        <h2>John Doe</h2>
        <p class="title">Designer</p>
        <p>Some text that describes me lorem ipsum ipsum lorem.</p>
        <p>example@example.com</p>
        <p><button class="button">Contact</button></p>
      </div>
    </div>
  </div>
</div>
</div>

<!-- <div class="col-12 right">
  <div class="aside">
    <h2>Space 1</h2>
    <p>These space for something use future</p>
    <h2>Space 2</h2>
    <p>These space for something use future</p>
    <h2>Space 3</h2>
    <p>These space for something use future</p>
  </div>
</div> -->

</div>

</body>
</html>
