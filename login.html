<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Login | Cast Solution</title>

  <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />
  <link rel="stylesheet" href="css/login_style.css">


</head>

<!-- 	header -->
 <header>

<a href="https://www.castsolutions.com.au/">
<img id="logo" src="img/LOGO-01.png"/>
</a>
</header>
  <body onload="checkCookie()">
	<div class="login">
		<div class="login-screen">
			<div class="login-title">
				<!-- <h4 style="margin-top: 10px; margin-bottom: 10px;">Login</h4> -->
				<img id="loginImg" src="img/login.png"/>
			</div><br>
			<div class="login-form">
				<div class="input-group">
				<input type="text" class="login-field" name="username" placeholder="username" id="login-name" required><br><br>
				<input type="password" class="login-field" name="password" placeholder="password" id="login-pass" required><br><br>
                <p id="test"></p>
				 <input class="btn"  type="submit" value="Login" name="login" onclick="showHint()"/>
				</div>

				<!-- <a class="resetPassword-link" href="resetpassword.html">Forgot your password?</a> -->
				<a id="forgotPass" onclick="myFunction1()" class="resetPassword-link">Forgot your password?</a>
				<br>
        </div>
		</div>
	</div>

		<div class="reset">
		<div class="login-screen">
			<div class="login-title">
				<!-- <h4 style="margin-top: 10px; margin-bottom: 10px;">Password Reset</h4> -->
				<img id="resetKey" src="img/key.png"/>
			</div><br>
				<p class="alartWords">Enter your email, and we'll send you instructions on how to reset your password.</p>
			<div class="reset-form">
				<form action="function-modified.php" method="POST">
				<div class="input-group">
				<input type="email" class="reset-email" name="email"  placeholder="Email" id="email-name" required></p>
				<input type="text" class="reset-user" name="username"  placeholder="Username" id="reset-username" required></p>
				<input type="submit" class="btn" name="forget" value="Send Me New Password"/>
        </form>
        <form action="login.html" method="POST">

        <input type="submit" class="btn" name="forget" value="Back"/><br><br>
      </form>

				<!-- <label class="label-reset-email" for="reset-pass"></label> -->
				</div>

			</div>
		</div>
	</div>


	<div class="col-12 right">
	  <div class="footer">
	    <p>&copy; 2017 Cast Solutions </p>
	  </div>
	</div>
</body>

<script>
function myFunction1() {
    var c = document.querySelectorAll(".login");
    if(c[0].style.display = "block"){
        c[0].style.display = "none";
    }
    var c2 = document.querySelectorAll(".reset");
    if(c2[0].style.display = "none"){
        c2[0].style.display = "block";
    }
}
var d = new Date();
var exdays = 30;
d.setTime(d.getTime()+(exdays*24*60*60*1000));
var expires = "expires="+d.toGMTString();
function setCookie(cname,cvalue,exdays){

	document.cookie = cname+"="+cvalue+"; "+expires;
}

function getCookie(cname){
	var name = cname + "=";
	var ca = document.cookie.split(';');
	for(var i=0; i<ca.length; i++) {
		var c = ca[i].trim();
		if (c.indexOf(name)==0) return c.substring(name.length,c.length);
	}
	return "";
}

function checkCookie(){
	var user=getCookie("username");
	if (user!=""){
		document.getElementById('login-name').value = user;
	}
	else {

		user = document.getElementById('login-name').value;
  		if (user!="" && user!=null){
    		setCookie("username",user,30);
    	}
	}
}

function setUsername(){
  setCookie("username",document.getElementById('login-name').value,30);
}

var hide = document.getElementById('login-pass');
hide.addEventListener("click",function(){
  document.getElementById('test').innerHTML = "";
});

var xmlHttp;
function showHint(){
  setUsername();
  xmlHttp = GetXmlHttpObject();
if (xmlHttp==null)
 {
 alert ("Browser does not support HTTP Request");
 return 0;
 }
 var url='function-modified.php';
 var params = "";
 params += "login=1&username="+document.getElementById('login-name').value;
 params += "&password="+document.getElementById('login-pass').value
 // var params = "username="+document.getElementById('reset-username').value+"&email="+document.getElementById('email-name').value;
 xmlHttp.open("POST",url,true);
 xmlHttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
 xmlHttp.onreadystatechange=stateChanged;
 xmlHttp.send(params);
}

function stateChanged(){
if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete"){
  if(xmlHttp.responseText=="no"){
    document.cookie = "loginstatus=no; "+expires;
    document.getElementById('test').innerHTML="Username or Password is Wrong,Please try again!";
    document.getElementById('login-pass').value="";
  }else if(xmlHttp.responseText=="admin"){
    document.cookie = "loginstatus=yes; "+expires;
    window.location = "./adminpage.html";
  }else if (xmlHttp.responseText=="user") {
    document.cookie = "loginstatus=yes; "+expires;
    window.location = "./userpage.html";
  }
 }
}

function GetXmlHttpObject(){
var xmlHttp=null;
try{
 // Firefox, Opera 8.0+, Safari
 xmlHttp=new XMLHttpRequest();
 }
catch (e){
 //Internet Explorer
 try{
  xmlHttp=new ActiveXObject("Msxml2.XMLHTTP");
  }
 catch (e){
  xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
 }
return xmlHttp;
}
</script>

<!--   footer -->
<!-- <footer> <P id="copy"> &copy; 2017 Cast Solutions   </P> </footer> -->
</html>
